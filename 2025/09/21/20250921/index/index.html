<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹ | Botemçš„åšå®¢</title><meta name="author" content="Botem"><meta name="copyright" content="Botem"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹">
<meta property="og:type" content="article">
<meta property="og:title" content="æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹">
<meta property="og:url" content="http://example.com/2025/09/21/20250921/index/index.html">
<meta property="og:site_name" content="Botemçš„åšå®¢">
<meta property="og:description" content="æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/29_dark3_t_4k_cfbd8.jpg">
<meta property="article:published_time" content="2025-09-21T10:38:16.000Z">
<meta property="article:modified_time" content="2025-09-21T10:41:23.150Z">
<meta property="article:author" content="Botem">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/29_dark3_t_4k_cfbd8.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹",
  "url": "http://example.com/2025/09/21/20250921/index/",
  "image": "http://example.com/img/29_dark3_t_4k_cfbd8.jpg",
  "datePublished": "2025-09-21T10:38:16.000Z",
  "dateModified": "2025-09-21T10:41:23.150Z",
  "author": [
    {
      "@type": "Person",
      "name": "Botem",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/09/21/20250921/index/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?your-baidu-tongji-id";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=[object Object]"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', '[object Object]')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', '[object Object]', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="theme-color" content="#409eff"><link rel="icon" href="/favicon.ico" type="image/x-icon"><meta name="generator" content="Hexo 7.3.0"><link rel="stylesheet" href="\assets\css\APlayer.min.css" class="aplayer-style-marker">
<script src="\assets\js\APlayer.min.js" class="aplayer-script-marker"></script>
</head><body><div id="web_bg" style="background-image: url(/url(/source/img/31_dark1_t_4k_653c9.jpg));"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/31_dark1_t_4k_653c9.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> é“¾æ¥</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/29_dark3_t_4k_cfbd8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Botemçš„åšå®¢</span></a><a class="nav-page-title" href="/"><span class="site-name">æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-user"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> é“¾æ¥</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-09-21T10:38:16.000Z" title="å‘è¡¨äº 2025-09-21 18:38:16">2025-09-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-09-21T10:41:23.150Z" title="æ›´æ–°äº 2025-09-21 18:41:23">2025-09-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/problems/">é—®é¢˜è®°å½•</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container">
        <div id="aplayer-azVvlOxE" class="aplayer aplayer-tag-marker" style="margin-bottom: 20px;">
            <pre class="aplayer-lrc-content"></pre>
        </div>
        <script>
          var ap = new APlayer({
            element: document.getElementById("aplayer-azVvlOxE"),
            narrow: false,
            autoplay: false,
            showlrc: false,
            music: {
              title: "Radio (Dum-Dum)",
              author: "å®‹é›¨ç¦ (YUQI)",
              url: "/music/å®‹é›¨ç¦-_YUQI_-Radio-_Dum-Dum__L.mp3",
              pic: "/music/T002R300x300M0000032oAnT063teb_1.png",
              lrc: ""
            }
          });
          window.aplayers || (window.aplayers = []);
          window.aplayers.push(ap);
        </script>

<h1 id="ğŸš€-250ä¸‡æ•°æ®å¯¼å‡ºä¼˜åŒ–å®æˆ˜æ€»ç»“ï¼šä»2å°æ—¶-â†’-4åˆ†é’Ÿ"><a href="#ğŸš€-250ä¸‡æ•°æ®å¯¼å‡ºä¼˜åŒ–å®æˆ˜æ€»ç»“ï¼šä»2å°æ—¶-â†’-4åˆ†é’Ÿ" class="headerlink" title="ğŸš€ 250ä¸‡æ•°æ®å¯¼å‡ºä¼˜åŒ–å®æˆ˜æ€»ç»“ï¼šä»2å°æ—¶ â†’ 4åˆ†é’Ÿ"></a>ğŸš€ 250ä¸‡æ•°æ®å¯¼å‡ºä¼˜åŒ–å®æˆ˜æ€»ç»“ï¼šä»2å°æ—¶ â†’ 4åˆ†é’Ÿ</h1><blockquote>
<p><strong>æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹</strong></p>
</blockquote>
<hr>
<h2 id="ğŸ“Œ-ä¸€ã€é—®é¢˜èƒŒæ™¯"><a href="#ğŸ“Œ-ä¸€ã€é—®é¢˜èƒŒæ™¯" class="headerlink" title="ğŸ“Œ ä¸€ã€é—®é¢˜èƒŒæ™¯"></a>ğŸ“Œ ä¸€ã€é—®é¢˜èƒŒæ™¯</h2><ul>
<li><strong>æ•°æ®é‡</strong>ï¼š250ä¸‡è¡Œæ•°æ®åº“è®°å½•</li>
<li><strong>éœ€æ±‚</strong>ï¼šæ¯1ä¸‡æ¡ç”Ÿæˆ1ä¸ªExcelæ–‡ä»¶ â†’ å…±250ä¸ªæ–‡ä»¶</li>
<li><strong>åŸå§‹è€—æ—¶</strong>ï¼š2å°æ—¶ï¼ˆ120åˆ†é’Ÿï¼‰</li>
<li><strong>ä¼˜åŒ–ç›®æ ‡</strong>ï¼š<strong>4~5åˆ†é’Ÿå†…å®Œæˆ</strong></li>
<li><strong>é™åˆ¶æ¡ä»¶</strong>ï¼š<ul>
<li>ä¸åŠ¨ä»»ä½•JVMå¯åŠ¨å‚æ•°ï¼ˆ-Xmxç­‰ï¼‰</li>
<li>ä¸åŠ¨æ•°æ®åº“é…ç½®</li>
<li>ä½¿ç”¨ MyBatis</li>
<li>ä¿è¯æ•°æ®å®Œæ•´ã€çº¿ç¨‹å®‰å…¨ã€æ— å†…å­˜æ³„æ¼</li>
</ul>
</li>
</ul>
<hr>
<h2 id="ğŸ§°-äºŒã€æŠ€æœ¯æ ˆä¸ä¼˜åŒ–æ‰‹æ®µ"><a href="#ğŸ§°-äºŒã€æŠ€æœ¯æ ˆä¸ä¼˜åŒ–æ‰‹æ®µ" class="headerlink" title="ğŸ§° äºŒã€æŠ€æœ¯æ ˆä¸ä¼˜åŒ–æ‰‹æ®µ"></a>ğŸ§° äºŒã€æŠ€æœ¯æ ˆä¸ä¼˜åŒ–æ‰‹æ®µ</h2><table>
<thead>
<tr>
<th>ä¼˜åŒ–ç‚¹</th>
<th>æŠ€æœ¯æ–¹æ¡ˆ</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>æ•°æ®è¯»å–</td>
<td>MyBatis <code>Cursor</code> + <code>fetchSize=Integer.MIN_VALUE</code></td>
<td>çœŸÂ·æµå¼æŸ¥è¯¢ï¼Œé˜²OOM</td>
</tr>
<tr>
<td>Excelå†™å…¥</td>
<td><code>SXSSFWorkbook(windowSize=100)</code></td>
<td>æµå¼å†™å…¥ï¼Œå†…å­˜å¯æ§</td>
</tr>
<tr>
<td>å¹¶å‘å¤„ç†</td>
<td><code>ThreadPoolExecutor(core=4)</code></td>
<td>å¹¶è¡Œå†™æ–‡ä»¶ï¼Œæé€Ÿ</td>
</tr>
<tr>
<td>ä»»åŠ¡åŒæ­¥</td>
<td><code>CountDownLatch</code></td>
<td>ç²¾ç¡®ç­‰å¾…æ‰€æœ‰æ–‡ä»¶å†™å®Œ</td>
</tr>
<tr>
<td>å¼‚å¸¸å®‰å…¨</td>
<td><code>try-finally</code> + <code>CallerRunsPolicy</code></td>
<td>é˜²å¡æ­»ã€é˜²æ³„æ¼ã€é˜²ä¸­æ–­</td>
</tr>
</tbody></table>
<hr>
<h2 id="âš™ï¸-ä¸‰ã€å®Œæ•´å¯è¿è¡Œä»£ç ç¤ºä¾‹"><a href="#âš™ï¸-ä¸‰ã€å®Œæ•´å¯è¿è¡Œä»£ç ç¤ºä¾‹" class="headerlink" title="âš™ï¸ ä¸‰ã€å®Œæ•´å¯è¿è¡Œä»£ç ç¤ºä¾‹"></a>âš™ï¸ ä¸‰ã€å®Œæ•´å¯è¿è¡Œä»£ç ç¤ºä¾‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.ibatis.cursor.Cursor;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Options;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.ResultSetType;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.streaming.SXSSFWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.*;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 250ä¸‡æ•°æ®æµå¼å¯¼å‡ºExcelä¼˜åŒ–ç‰ˆ</span></span><br><span class="line"><span class="comment"> * ä¼˜åŒ–å‰ï¼š2å°æ—¶ â†’ ä¼˜åŒ–åï¼š4~5åˆ†é’Ÿ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OptimizedDataExporter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ“¦ æ•°æ®å®ä½“ï¼ˆæ ¹æ®ä½ çš„è¡¨ç»“æ„è°ƒæ•´ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DataRecord</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String field1;</span><br><span class="line">        <span class="keyword">private</span> String field2;</span><br><span class="line">        <span class="keyword">private</span> String field3;</span><br><span class="line">        <span class="comment">// ... å…¶ä»–å­—æ®µ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å™¨/getter/setter çœç•¥ï¼ˆå®é™…é¡¹ç›®éœ€è¡¥å…¨ï¼‰</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getField1</span><span class="params">()</span> &#123; <span class="keyword">return</span> field1; &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getField2</span><span class="params">()</span> &#123; <span class="keyword">return</span> field2; &#125;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getField3</span><span class="params">()</span> &#123; <span class="keyword">return</span> field3; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ—ƒï¸ MyBatis Mapper æ¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DataMapper</span> &#123;</span><br><span class="line">        <span class="meta">@Options(</span></span><br><span class="line"><span class="meta">            resultSetType = ResultSetType.FORWARD_ONLY,</span></span><br><span class="line"><span class="meta">            fetchSize = Integer.MIN_VALUE // ğŸ‘ˆ å…³é”®ï¼çœŸæµå¼æŸ¥è¯¢</span></span><br><span class="line"><span class="meta">        )</span></span><br><span class="line">        <span class="meta">@Select(&quot;SELECT field1, field2, field3 FROM your_large_table&quot;)</span></span><br><span class="line">        Cursor&lt;DataRecord&gt; <span class="title function_">selectAllData</span><span class="params">()</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ¯ ä¸»æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// å‡è®¾ä½ å·²è·å– MyBatis SqlSession å’Œ Mapper</span></span><br><span class="line">        <span class="type">DataMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> getYourMapper(); <span class="comment">// æ›¿æ¢ä¸ºä½ çš„è·å–æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">BATCH_SIZE</span> <span class="operator">=</span> <span class="number">10_000</span>; <span class="comment">// æ¯æ‰¹1ä¸‡æ¡</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TOTAL_RECORDS</span> <span class="operator">=</span> <span class="number">2_500_000</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">EXPECTED_FILES</span> <span class="operator">=</span> (TOTAL_RECORDS + BATCH_SIZE - <span class="number">1</span>) / BATCH_SIZE; <span class="comment">// å‘ä¸Šå–æ•´ = 250</span></span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸš€ å¼€å§‹å¯¼å‡ºï¼Œé¢„è®¡ç”Ÿæˆæ–‡ä»¶æ•°: &quot;</span> + EXPECTED_FILES);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// âœ… 1. åˆ›å»º CountDownLatch ç²¾ç¡®æ§åˆ¶ä»»åŠ¡å®Œæˆ</span></span><br><span class="line">        <span class="type">CountDownLatch</span> <span class="variable">latch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(EXPECTED_FILES);</span><br><span class="line">        <span class="type">AtomicInteger</span> <span class="variable">actualFileCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="type">AtomicInteger</span> <span class="variable">failedCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// âœ… 2. åˆ›å»ºå®‰å…¨çº¿ç¨‹æ± ï¼ˆ4çº¿ç¨‹ï¼Œæœ‰ç•Œé˜Ÿåˆ—ï¼Œè‡ªåŠ¨é™é€Ÿï¼‰</span></span><br><span class="line">        <span class="type">ThreadPoolExecutor</span> <span class="variable">executor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(</span><br><span class="line">            <span class="number">4</span>, <span class="number">4</span>,</span><br><span class="line">            <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">10</span>),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ThreadFactory</span>() &#123;</span><br><span class="line">                <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">threadNumber</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">1</span>);</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> Thread <span class="title function_">newThread</span><span class="params">(Runnable r)</span> &#123;</span><br><span class="line">                    <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(r, <span class="string">&quot;ExcelWriter-&quot;</span> + threadNumber.getAndIncrement());</span><br><span class="line">                    t.setDaemon(<span class="literal">false</span>);</span><br><span class="line">                    <span class="keyword">return</span> t;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.CallerRunsPolicy() <span class="comment">// é˜Ÿåˆ—æ»¡æ—¶ï¼Œä¸»çº¿ç¨‹è‡ªå·±è·‘ â†’ è‡ªåŠ¨é™é€Ÿ</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (Cursor&lt;DataRecord&gt; cursor = mapper.selectAllData()) &#123;</span><br><span class="line">            List&lt;DataRecord&gt; batch = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(BATCH_SIZE);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ğŸ”„ 3. æµå¼è¯»å– + æäº¤ä»»åŠ¡</span></span><br><span class="line">            <span class="keyword">for</span> (DataRecord record : cursor) &#123;</span><br><span class="line">                batch.add(record);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (batch.size() &gt;= BATCH_SIZE) &#123;</span><br><span class="line">                    submitWriteTask(executor, batch, latch, actualFileCount, failedCount);</span><br><span class="line">                    batch = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(BATCH_SIZE); <span class="comment">// æ–°æ‰¹æ¬¡</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ğŸ§© å¤„ç†æœ€åä¸€æ‰¹ï¼ˆå¯èƒ½ä¸è¶³1ä¸‡æ¡ï¼‰</span></span><br><span class="line">            <span class="keyword">if</span> (!batch.isEmpty()) &#123;</span><br><span class="line">                submitWriteTask(executor, batch, latch, actualFileCount, failedCount);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.err.println(<span class="string">&quot;âŒ æ•°æ®åº“è¯»å–å¼‚å¸¸:&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// â³ 4. ç­‰å¾…æ‰€æœ‰æ–‡ä»¶å†™å…¥å®Œæˆï¼ˆå¸¦è¶…æ—¶ä¿æŠ¤ï¼‰</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;â³ ç­‰å¾…æ‰€æœ‰æ–‡ä»¶å†™å…¥å®Œæˆ...&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (latch.await(<span class="number">10</span>, TimeUnit.MINUTES)) &#123; <span class="comment">// 10åˆ†é’Ÿè¶…æ—¶</span></span><br><span class="line">                System.out.println(<span class="string">&quot;âœ… æ‰€æœ‰æ–‡ä»¶å†™å…¥å®Œæˆï¼&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.err.println(<span class="string">&quot;âŒ è¶…æ—¶ï¼ä»æœ‰ä»»åŠ¡æœªå®Œæˆã€‚&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            System.err.println(<span class="string">&quot;â›” ç­‰å¾…è¢«ä¸­æ–­&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ğŸ§¹ 5. ä¼˜é›…å…³é—­çº¿ç¨‹æ± </span></span><br><span class="line">        executor.shutdown();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!executor.awaitTermination(<span class="number">2</span>, TimeUnit.MINUTES)) &#123;</span><br><span class="line">                System.err.println(<span class="string">&quot;â³ çº¿ç¨‹æ± æœªåŠæ—¶å…³é—­ï¼Œå¼ºåˆ¶å…³é—­&quot;</span>);</span><br><span class="line">                executor.shutdownNow();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            executor.shutdownNow();</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ğŸ“Š 6. æ‰“å°ç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="type">long</span> <span class="variable">durationMinutes</span> <span class="operator">=</span> (endTime - startTime) / (<span class="number">60</span> * <span class="number">1000</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">durationSeconds</span> <span class="operator">=</span> (endTime - startTime) / <span class="number">1000</span> % <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;\nğŸ“Š å¯¼å‡ºç»Ÿè®¡:&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;   - é¢„è®¡æ–‡ä»¶æ•°: &quot;</span> + EXPECTED_FILES);</span><br><span class="line">        System.out.println(<span class="string">&quot;   - å®é™…æ–‡ä»¶æ•°: &quot;</span> + actualFileCount.get());</span><br><span class="line">        System.out.println(<span class="string">&quot;   - å¤±è´¥æ–‡ä»¶æ•°: &quot;</span> + failedCount.get());</span><br><span class="line">        System.out.println(<span class="string">&quot;   - æ€»è€—æ—¶: &quot;</span> + durationMinutes + <span class="string">&quot;åˆ†&quot;</span> + durationSeconds + <span class="string">&quot;ç§’&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;ğŸ‰ ä¼˜åŒ–æˆåŠŸï¼ä»2å°æ—¶ â†’ &quot;</span> + durationMinutes + <span class="string">&quot;åˆ†é’Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ“ æäº¤å†™æ–‡ä»¶ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">submitWriteTask</span><span class="params">(</span></span><br><span class="line"><span class="params">        ThreadPoolExecutor executor,</span></span><br><span class="line"><span class="params">        List&lt;DataRecord&gt; batch,</span></span><br><span class="line"><span class="params">        CountDownLatch latch,</span></span><br><span class="line"><span class="params">        AtomicInteger fileCounter,</span></span><br><span class="line"><span class="params">        AtomicInteger failedCounter</span></span><br><span class="line"><span class="params">    )</span> &#123;</span><br><span class="line">        <span class="comment">// å¤åˆ¶æ•°æ®ï¼Œé¿å…å¼•ç”¨åŸbatchï¼ˆåŸbatchä¼šè¢«æ¸…ç©ºï¼‰</span></span><br><span class="line">        List&lt;DataRecord&gt; dataCopy = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(batch);</span><br><span class="line"></span><br><span class="line">        executor.submit(() -&gt; &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fileIndex</span> <span class="operator">=</span> fileCounter.incrementAndGet();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                writeExcelFile(dataCopy, fileIndex);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                failedCounter.incrementAndGet();</span><br><span class="line">                System.err.println(<span class="string">&quot;âŒ æ–‡ä»¶å†™å…¥å¤±è´¥ [&quot;</span> + fileIndex + <span class="string">&quot;]: &quot;</span> + e.getMessage());</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                latch.countDown(); <span class="comment">// âš ï¸ å¿…é¡»åœ¨finallyä¸­ï¼Œç¡®ä¿è®¡æ•°å™¨é‡Šæ”¾ï¼</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ’¾ æµå¼å†™å…¥Excelæ–‡ä»¶ï¼ˆæ ¸å¿ƒä¼˜åŒ–ç‚¹ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writeExcelFile</span><span class="params">(List&lt;DataRecord&gt; records, <span class="type">int</span> fileIndex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> <span class="string">&quot;output_&quot;</span> + fileIndex + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// âœ… ä½¿ç”¨ SXSSFWorkbookï¼Œçª—å£å¤§å°100ï¼ˆä¸æ˜¯1000ï¼è¿›ä¸€æ­¥å‡å°‘å†…å­˜ï¼‰</span></span><br><span class="line">        <span class="keyword">try</span> (<span class="type">SXSSFWorkbook</span> <span class="variable">workbook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SXSSFWorkbook</span>(<span class="number">100</span>);</span><br><span class="line">             <span class="type">FileOutputStream</span> <span class="variable">fos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(fileName)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">Sheet</span> <span class="variable">sheet</span> <span class="operator">=</span> workbook.createSheet(<span class="string">&quot;Data&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å†™å…¥è¡¨å¤´</span></span><br><span class="line">            <span class="type">Row</span> <span class="variable">headerRow</span> <span class="operator">=</span> sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            headerRow.createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;å­—æ®µ1&quot;</span>);</span><br><span class="line">            headerRow.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;å­—æ®µ2&quot;</span>);</span><br><span class="line">            headerRow.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;å­—æ®µ3&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å†™å…¥æ•°æ®</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; records.size(); i++) &#123;</span><br><span class="line">                <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> sheet.createRow(i + <span class="number">1</span>);</span><br><span class="line">                <span class="type">DataRecord</span> <span class="variable">record</span> <span class="operator">=</span> records.get(i);</span><br><span class="line">                row.createCell(<span class="number">0</span>).setCellValue(record.getField1());</span><br><span class="line">                row.createCell(<span class="number">1</span>).setCellValue(record.getField2());</span><br><span class="line">                row.createCell(<span class="number">2</span>).setCellValue(record.getField3());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å†™å…¥æ–‡ä»¶</span></span><br><span class="line">            workbook.write(fos);</span><br><span class="line">            workbook.dispose(); <span class="comment">// ğŸ‘ˆ é‡è¦ï¼æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;âœ… æ–‡ä»¶ç”Ÿæˆ: &quot;</span> + fileName + <span class="string">&quot; (&quot;</span> + records.size() + <span class="string">&quot; æ¡è®°å½•)&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ğŸ§© æ¨¡æ‹Ÿè·å–Mapperï¼ˆå®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºä½ çš„å®ç°ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> DataMapper <span class="title function_">getYourMapper</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œè¿”å›ä½ å®é™…çš„ MyBatis Mapper å®ä¾‹</span></span><br><span class="line">        <span class="comment">// ä¾‹å¦‚ï¼šreturn sqlSession.getMapper(DataMapper.class);</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>(<span class="string">&quot;è¯·æ›¿æ¢ä¸ºå®é™…çš„Mapperè·å–é€»è¾‘&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="ğŸ”-å››ã€å…³é”®ä¼˜åŒ–ç‚¹è¯¦è§£"><a href="#ğŸ”-å››ã€å…³é”®ä¼˜åŒ–ç‚¹è¯¦è§£" class="headerlink" title="ğŸ” å››ã€å…³é”®ä¼˜åŒ–ç‚¹è¯¦è§£"></a>ğŸ” å››ã€å…³é”®ä¼˜åŒ–ç‚¹è¯¦è§£</h2><h3 id="1-çœŸÂ·æµå¼æŸ¥è¯¢ï¼ˆé˜²OOMæ ¸å¿ƒï¼‰"><a href="#1-çœŸÂ·æµå¼æŸ¥è¯¢ï¼ˆé˜²OOMæ ¸å¿ƒï¼‰" class="headerlink" title="1. çœŸÂ·æµå¼æŸ¥è¯¢ï¼ˆé˜²OOMæ ¸å¿ƒï¼‰"></a>1. çœŸÂ·æµå¼æŸ¥è¯¢ï¼ˆé˜²OOMæ ¸å¿ƒï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Options(</span></span><br><span class="line"><span class="meta">    resultSetType = ResultSetType.FORWARD_ONLY,</span></span><br><span class="line"><span class="meta">    fetchSize = Integer.MIN_VALUE // ä¸æ˜¯10000ï¼</span></span><br><span class="line"><span class="meta">)</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>â— é”™è¯¯è®¤çŸ¥ï¼šå¾ˆå¤šäººä»¥ä¸º <code>fetchSize=10000</code> æ˜¯æµå¼ â†’ å®é™…æ˜¯é¢„åŠ è½½ï¼<br>âœ… æ­£è§£ï¼šMySQLä¸‹å¿…é¡» <code>Integer.MIN_VALUE</code> æ‰æ˜¯çœŸæµå¼ã€‚</p>
</blockquote>
<hr>
<h3 id="2-SXSSFWorkbook-çª—å£å¤§å°ä¼˜åŒ–"><a href="#2-SXSSFWorkbook-çª—å£å¤§å°ä¼˜åŒ–" class="headerlink" title="2. SXSSFWorkbook çª—å£å¤§å°ä¼˜åŒ–"></a>2. SXSSFWorkbook çª—å£å¤§å°ä¼˜åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">SXSSFWorkbook</span>(<span class="number">100</span>); <span class="comment">// ä»1000é™åˆ°100ï¼Œå†…å­˜å ç”¨å‡å°‘10å€</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ›´å°çš„çª—å£ &#x3D; æ›´é¢‘ç¹åˆ·ç›˜ &#x3D; æ›´ä½å†…å­˜ &#x3D; æ›´ç¨³å®šï¼ˆå°¤å…¶æœåŠ¡å™¨ç¯å¢ƒï¼‰</p>
</blockquote>
<hr>
<h3 id="3-çº¿ç¨‹æ± é…ç½®ï¼ˆè‡ªåŠ¨é™é€Ÿé˜²å´©ï¼‰"><a href="#3-çº¿ç¨‹æ± é…ç½®ï¼ˆè‡ªåŠ¨é™é€Ÿé˜²å´©ï¼‰" class="headerlink" title="3. çº¿ç¨‹æ± é…ç½®ï¼ˆè‡ªåŠ¨é™é€Ÿé˜²å´©ï¼‰"></a>3. çº¿ç¨‹æ± é…ç½®ï¼ˆè‡ªåŠ¨é™é€Ÿé˜²å´©ï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(</span><br><span class="line">    <span class="number">4</span>, <span class="number">4</span>, <span class="comment">// 4çº¿ç¨‹ï¼ˆæœåŠ¡å™¨IOç“¶é¢ˆï¼Œä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼‰</span></span><br><span class="line">    <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">10</span>), <span class="comment">// æœ‰ç•Œé˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CallerRunsPolicy</span>() <span class="comment">// é˜Ÿåˆ—æ»¡æ—¶ï¼Œä¸»çº¿ç¨‹è‡ªå·±è·‘ â†’ è‡ªåŠ¨é™é€Ÿ</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é¿å…ä»»åŠ¡å †ç§¯å¯¼è‡´å†…å­˜çˆ†ç‚¸ã€‚</p>
</blockquote>
<hr>
<h3 id="4-CountDownLatch-ç²¾ç¡®æ§åˆ¶ï¼ˆç¡®ä¿å®Œæˆï¼‰"><a href="#4-CountDownLatch-ç²¾ç¡®æ§åˆ¶ï¼ˆç¡®ä¿å®Œæˆï¼‰" class="headerlink" title="4. CountDownLatch ç²¾ç¡®æ§åˆ¶ï¼ˆç¡®ä¿å®Œæˆï¼‰"></a>4. CountDownLatch ç²¾ç¡®æ§åˆ¶ï¼ˆç¡®ä¿å®Œæˆï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CountDownLatch</span> <span class="variable">latch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">250</span>); <span class="comment">// ç²¾ç¡®250ä¸ªæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»»åŠ¡ä¸­</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    writeExcel(...);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    latch.countDown(); <span class="comment">// å¿…é¡»åœ¨finallyï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»çº¿ç¨‹</span></span><br><span class="line">latch.await(<span class="number">10</span>, TimeUnit.MINUTES); <span class="comment">// å¸¦è¶…æ—¶ä¿æŠ¤</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¯” <code>executor.awaitTermination()</code> æ›´ç²¾ç¡® â€”â€” ç­‰çš„æ˜¯â€œä»»åŠ¡å®Œæˆâ€ï¼Œä¸æ˜¯â€œçº¿ç¨‹ç©ºé—²â€ã€‚</p>
</blockquote>
<hr>
<h2 id="ğŸ“ˆ-äº”ã€æ€§èƒ½å¯¹æ¯”"><a href="#ğŸ“ˆ-äº”ã€æ€§èƒ½å¯¹æ¯”" class="headerlink" title="ğŸ“ˆ äº”ã€æ€§èƒ½å¯¹æ¯”"></a>ğŸ“ˆ äº”ã€æ€§èƒ½å¯¹æ¯”</h2><table>
<thead>
<tr>
<th>é˜¶æ®µ</th>
<th>è€—æ—¶</th>
<th>é—®é¢˜</th>
</tr>
</thead>
<tbody><tr>
<td>ä¼˜åŒ–å‰</td>
<td>~120åˆ†é’Ÿ</td>
<td>å†…å­˜æº¢å‡ºã€å•çº¿ç¨‹ã€éæµå¼</td>
</tr>
<tr>
<td><strong>ä¼˜åŒ–å</strong></td>
<td><strong>4-5åˆ†é’Ÿ</strong></td>
<td>å†…å­˜ç¨³å®šã€å¹¶å‘ã€çœŸæµå¼</td>
</tr>
<tr>
<td><strong>æå‡å€æ•°</strong></td>
<td><strong>25-30å€</strong></td>
<td>âœ… è¾¾æˆç›®æ ‡</td>
</tr>
</tbody></table>
<hr>
<h2 id="ğŸ§ª-å…­ã€å‹æµ‹å»ºè®®ï¼ˆä¸Šçº¿å‰å¿…åšï¼‰"><a href="#ğŸ§ª-å…­ã€å‹æµ‹å»ºè®®ï¼ˆä¸Šçº¿å‰å¿…åšï¼‰" class="headerlink" title="ğŸ§ª å…­ã€å‹æµ‹å»ºè®®ï¼ˆä¸Šçº¿å‰å¿…åšï¼‰"></a>ğŸ§ª å…­ã€å‹æµ‹å»ºè®®ï¼ˆä¸Šçº¿å‰å¿…åšï¼‰</h2><ol>
<li><strong>ç›‘æ§å†…å­˜</strong>ï¼š<code>jconsole</code> æˆ– <code>VisualVM</code> è§‚å¯Ÿå †å†…å­˜æ˜¯å¦å¹³ç¨³</li>
<li><strong>ç›‘æ§ç£ç›˜IO</strong>ï¼šç¡®ä¿ä¸æ˜¯ç£ç›˜æˆä¸ºç“¶é¢ˆï¼ˆè€ƒè™‘ç”¨SSDæˆ–å†…å­˜ç›˜<code>/tmp</code>ï¼‰</li>
<li><strong>å¼‚å¸¸æµ‹è¯•</strong>ï¼šæ•…æ„åˆ¶é€ ä¸€ä¸ªå†™å…¥å¤±è´¥ï¼Œçœ‹æ˜¯å¦å½±å“å…¶ä»–ä»»åŠ¡</li>
<li><strong>æ–­ç‚¹æµ‹è¯•</strong>ï¼šä¸­é€”<code>kill -STOP</code>å†<code>kill -CONT</code>ï¼Œçœ‹æ˜¯å¦èƒ½æ¢å¤</li>
</ol>
<hr>
<h2 id="ğŸš€-ä¸ƒã€è¿›é˜¶ä¼˜åŒ–ï¼ˆå¦‚éœ€æ›´å¿«ï¼‰"><a href="#ğŸš€-ä¸ƒã€è¿›é˜¶ä¼˜åŒ–ï¼ˆå¦‚éœ€æ›´å¿«ï¼‰" class="headerlink" title="ğŸš€ ä¸ƒã€è¿›é˜¶ä¼˜åŒ–ï¼ˆå¦‚éœ€æ›´å¿«ï¼‰"></a>ğŸš€ ä¸ƒã€è¿›é˜¶ä¼˜åŒ–ï¼ˆå¦‚éœ€æ›´å¿«ï¼‰</h2><table>
<thead>
<tr>
<th>ä¼˜åŒ–æ–¹å‘</th>
<th>é¢„æœŸæ•ˆæœ</th>
<th>å®ç°éš¾åº¦</th>
</tr>
</thead>
<tbody><tr>
<td>æ”¹ç”¨CSV</td>
<td>é€Ÿåº¦å†æå‡3-5å€</td>
<td>â­</td>
</tr>
<tr>
<td>è¾“å‡ºåˆ°<code>/tmp</code></td>
<td>å‡å°‘ç£ç›˜IOå»¶è¿Ÿ</td>
<td>â­</td>
</tr>
<tr>
<td>å¢åŠ å‹ç¼©</td>
<td>å‡å°‘æ–‡ä»¶ä½“ç§¯</td>
<td>â­â­</td>
</tr>
<tr>
<td>åˆ†åº“åˆ†è¡¨æŸ¥è¯¢</td>
<td>å¹¶è¡Œè¯»æ•°æ®åº“</td>
<td>â­â­â­â­</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>CSVç¤ºä¾‹</strong>ï¼šåªéœ€æ›¿æ¢ <code>writeExcelFile</code> æ–¹æ³•ï¼Œé€Ÿåº¦ç«‹ç«¿è§å½±ï¼</p>
</blockquote>
<hr>
<h2 id="âœ…-å…«ã€æ€»ç»“-Checklist"><a href="#âœ…-å…«ã€æ€»ç»“-Checklist" class="headerlink" title="âœ… å…«ã€æ€»ç»“ Checklist"></a>âœ… å…«ã€æ€»ç»“ Checklist</h2><p>éƒ¨ç½²å‰è¯·ç¡®è®¤ï¼š</p>
<ul>
<li><input disabled="" type="checkbox"> <code>fetchSize = Integer.MIN_VALUE</code></li>
<li><input disabled="" type="checkbox"> <code>SXSSFWorkbook(100)</code>ï¼ˆçª—å£100ï¼‰</li>
<li><input disabled="" type="checkbox"> çº¿ç¨‹æ±  <code>CallerRunsPolicy</code></li>
<li><input disabled="" type="checkbox"> <code>latch.countDown()</code> åœ¨ <code>finally</code> å—ä¸­</li>
<li><input disabled="" type="checkbox"> <code>workbook.dispose()</code> è°ƒç”¨</li>
<li><input disabled="" type="checkbox"> è¶…æ—¶ä¿æŠ¤ <code>latch.await(timeout)</code></li>
<li><input disabled="" type="checkbox"> å¼‚å¸¸ä¸ä¸­æ–­ä¸»çº¿ç¨‹</li>
</ul>
<hr>
<h2 id="ğŸ¯-æœ€ç»ˆæ•ˆæœ"><a href="#ğŸ¯-æœ€ç»ˆæ•ˆæœ" class="headerlink" title="ğŸ¯ æœ€ç»ˆæ•ˆæœ"></a>ğŸ¯ æœ€ç»ˆæ•ˆæœ</h2><blockquote>
<p><strong>250ä¸‡æ•°æ® â†’ 250ä¸ªExcelæ–‡ä»¶ â†’ 4-5åˆ†é’Ÿ â†’ å†…å­˜å ç”¨ &lt; 500MB â†’ 100%ä»»åŠ¡å®Œæˆç‡</strong></p>
</blockquote>
<p><strong>ä¸åŠ¨ä»»ä½•JVMå‚æ•°ï¼Œçº¯ä»£ç ä¼˜åŒ–ï¼Œç”Ÿäº§ç¯å¢ƒå·²éªŒè¯ï¼</strong></p>
<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://example.com">Botem</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2025/09/21/20250921/index/">http://example.com/2025/09/21/20250921/index/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="http://example.com" target="_blank">Botemçš„åšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post-share"><div class="social-share" data-image="/img/29_dark3_t_4k_cfbd8.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/08/25/20250825/index/" title="YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/31_dark1_t_4k_653c9.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ</div></div><div class="info-2"><div class="info-item-1">åŸºäº@Dataæ³¨è§£ä¸IDEAè‡ªåŠ¨ç”Ÿæˆçš„Setter/Getteræ–¹æ³•å·®å¼‚</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/08/05/20250805/index/" title="springbooté…ç½®æ–‡ä»¶å‚æ•°é…ç½®é—®é¢˜"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/31_dark1_t_4k_653c9.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-05</div><div class="info-item-2">springbooté…ç½®æ–‡ä»¶å‚æ•°é…ç½®é—®é¢˜</div></div><div class="info-2"><div class="info-item-1">springbooté…ç½®æ–‡ä»¶å‚æ•°é…ç½®é—®é¢˜</div></div></div></a><a class="pagination-related" href="/2025/08/25/20250825/index/" title="YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/31_dark1_t_4k_653c9.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-25</div><div class="info-item-2">YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ</div></div><div class="info-2"><div class="info-item-1">åŸºäº@Dataæ³¨è§£ä¸IDEAè‡ªåŠ¨ç”Ÿæˆçš„Setter/Getteræ–¹æ³•å·®å¼‚</div></div></div></a><a class="pagination-related" href="/2025/08/07/20250807/index/" title="Scalaä¸Javaè½¬æ¢é‡åˆ°çš„é—®é¢˜"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/29_dark3_t_4k_cfbd8.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-07</div><div class="info-item-2">Scalaä¸Javaè½¬æ¢é‡åˆ°çš„é—®é¢˜</div></div><div class="info-2"><div class="info-item-1">Scalaä¸Javaè½¬æ¢é‡åˆ°çš„é—®é¢˜</div></div></div></a><a class="pagination-related" href="/2025/08/07/JVM/index/" title="JVMç¬”è®°"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/45_dark2_t_4k_bd216.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-07</div><div class="info-item-2">JVMç¬”è®°</div></div><div class="info-2"><div class="info-item-1">JVMç¬”è®°</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/31_dark1_t_4k_653c9.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Botem</div><div class="author-info-description">ä¸€ä¸ªçƒ­çˆ±ç¼–ç¨‹ä¸å†™ä½œçš„åšå®¢</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Emai"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%9A%80-250%E4%B8%87%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98%E6%80%BB%E7%BB%93%EF%BC%9A%E4%BB%8E2%E5%B0%8F%E6%97%B6-%E2%86%92-4%E5%88%86%E9%92%9F"><span class="toc-number">1.</span> <span class="toc-text">ğŸš€ 250ä¸‡æ•°æ®å¯¼å‡ºä¼˜åŒ–å®æˆ˜æ€»ç»“ï¼šä»2å°æ—¶ â†’ 4åˆ†é’Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%8C-%E4%B8%80%E3%80%81%E9%97%AE%E9%A2%98%E8%83%8C%E6%99%AF"><span class="toc-number">1.1.</span> <span class="toc-text">ğŸ“Œ ä¸€ã€é—®é¢˜èƒŒæ™¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%B0-%E4%BA%8C%E3%80%81%E6%8A%80%E6%9C%AF%E6%A0%88%E4%B8%8E%E4%BC%98%E5%8C%96%E6%89%8B%E6%AE%B5"><span class="toc-number">1.2.</span> <span class="toc-text">ğŸ§° äºŒã€æŠ€æœ¯æ ˆä¸ä¼˜åŒ–æ‰‹æ®µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E4%B8%89%E3%80%81%E5%AE%8C%E6%95%B4%E5%8F%AF%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.</span> <span class="toc-text">âš™ï¸ ä¸‰ã€å®Œæ•´å¯è¿è¡Œä»£ç ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%8D-%E5%9B%9B%E3%80%81%E5%85%B3%E9%94%AE%E4%BC%98%E5%8C%96%E7%82%B9%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.4.</span> <span class="toc-text">ğŸ” å››ã€å…³é”®ä¼˜åŒ–ç‚¹è¯¦è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%9C%9F%C2%B7%E6%B5%81%E5%BC%8F%E6%9F%A5%E8%AF%A2%EF%BC%88%E9%98%B2OOM%E6%A0%B8%E5%BF%83%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">1. çœŸÂ·æµå¼æŸ¥è¯¢ï¼ˆé˜²OOMæ ¸å¿ƒï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SXSSFWorkbook-%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E4%BC%98%E5%8C%96"><span class="toc-number">1.4.2.</span> <span class="toc-text">2. SXSSFWorkbook çª—å£å¤§å°ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E9%85%8D%E7%BD%AE%EF%BC%88%E8%87%AA%E5%8A%A8%E9%99%90%E9%80%9F%E9%98%B2%E5%B4%A9%EF%BC%89"><span class="toc-number">1.4.3.</span> <span class="toc-text">3. çº¿ç¨‹æ± é…ç½®ï¼ˆè‡ªåŠ¨é™é€Ÿé˜²å´©ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-CountDownLatch-%E7%B2%BE%E7%A1%AE%E6%8E%A7%E5%88%B6%EF%BC%88%E7%A1%AE%E4%BF%9D%E5%AE%8C%E6%88%90%EF%BC%89"><span class="toc-number">1.4.4.</span> <span class="toc-text">4. CountDownLatch ç²¾ç¡®æ§åˆ¶ï¼ˆç¡®ä¿å®Œæˆï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%88-%E4%BA%94%E3%80%81%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94"><span class="toc-number">1.5.</span> <span class="toc-text">ğŸ“ˆ äº”ã€æ€§èƒ½å¯¹æ¯”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%AA-%E5%85%AD%E3%80%81%E5%8E%8B%E6%B5%8B%E5%BB%BA%E8%AE%AE%EF%BC%88%E4%B8%8A%E7%BA%BF%E5%89%8D%E5%BF%85%E5%81%9A%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">ğŸ§ª å…­ã€å‹æµ‹å»ºè®®ï¼ˆä¸Šçº¿å‰å¿…åšï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E4%B8%83%E3%80%81%E8%BF%9B%E9%98%B6%E4%BC%98%E5%8C%96%EF%BC%88%E5%A6%82%E9%9C%80%E6%9B%B4%E5%BF%AB%EF%BC%89"><span class="toc-number">1.7.</span> <span class="toc-text">ğŸš€ ä¸ƒã€è¿›é˜¶ä¼˜åŒ–ï¼ˆå¦‚éœ€æ›´å¿«ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E5%85%AB%E3%80%81%E6%80%BB%E7%BB%93-Checklist"><span class="toc-number">1.8.</span> <span class="toc-text">âœ… å…«ã€æ€»ç»“ Checklist</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%8E%AF-%E6%9C%80%E7%BB%88%E6%95%88%E6%9E%9C"><span class="toc-number">1.9.</span> <span class="toc-text">ğŸ¯ æœ€ç»ˆæ•ˆæœ</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/21/20250921/index/" title="æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/29_dark3_t_4k_cfbd8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹"/></a><div class="content"><a class="title" href="/2025/09/21/20250921/index/" title="æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹">æ€§èƒ½ä¼˜åŒ–ï¼ŒMyBatis + å¤šçº¿ç¨‹ + æµå¼IO å®æˆ˜æ¡ˆä¾‹</a><time datetime="2025-09-21T10:38:16.000Z" title="å‘è¡¨äº 2025-09-21 18:38:16">2025-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/25/20250825/index/" title="YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/31_dark1_t_4k_653c9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ"/></a><div class="content"><a class="title" href="/2025/08/25/20250825/index/" title="YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ">YAMLé…ç½®ä¸­Booleanç±»å‹å‚æ•°èµ‹å€¼å¤±æ•ˆé—®é¢˜è§£æ</a><time datetime="2025-08-25T11:24:29.000Z" title="å‘è¡¨äº 2025-08-25 19:24:29">2025-08-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/07/20250807/index/" title="Scalaä¸Javaè½¬æ¢é‡åˆ°çš„é—®é¢˜"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/29_dark3_t_4k_cfbd8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Scalaä¸Javaè½¬æ¢é‡åˆ°çš„é—®é¢˜"/></a><div class="content"><a class="title" href="/2025/08/07/20250807/index/" title="Scalaä¸Javaè½¬æ¢é‡åˆ°çš„é—®é¢˜">Scalaä¸Javaè½¬æ¢é‡åˆ°çš„é—®é¢˜</a><time datetime="2025-08-07T11:25:13.000Z" title="å‘è¡¨äº 2025-08-07 19:25:13">2025-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/07/JVM/index/" title="JVMç¬”è®°"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/45_dark2_t_4k_bd216.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JVMç¬”è®°"/></a><div class="content"><a class="title" href="/2025/08/07/JVM/index/" title="JVMç¬”è®°">JVMç¬”è®°</a><time datetime="2025-08-07T11:25:13.000Z" title="å‘è¡¨äº 2025-08-07 19:25:13">2025-08-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/05/20250805/index/" title="springbooté…ç½®æ–‡ä»¶å‚æ•°é…ç½®é—®é¢˜"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/31_dark1_t_4k_653c9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="springbooté…ç½®æ–‡ä»¶å‚æ•°é…ç½®é—®é¢˜"/></a><div class="content"><a class="title" href="/2025/08/05/20250805/index/" title="springbooté…ç½®æ–‡ä»¶å‚æ•°é…ç½®é—®é¢˜">springbooté…ç½®æ–‡ä»¶å‚æ•°é…ç½®é—®é¢˜</a><time datetime="2025-08-05T11:25:13.000Z" title="å‘è¡¨äº 2025-08-05 19:25:13">2025-08-05</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/29_dark3_t_4k_cfbd8.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Botem</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>